<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uvateca - In√≠cio</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header class="main-header">
        <a href="index.html" class="logo">Uvateca</a>
        <nav class="main-nav">
            <ul>
                <li><a href="index.html">In√≠cio</a></li>
                <li><a href="categoria.html">Categoria</a></li>
                <li><a href="about.html">Contato</a></li>
            </ul>
        </nav>
        <div class="user-icon">
            <a href="#" id="user-icon-btn">
                <img src="menu.png" alt="Menu do Usu√°rio" class="user-icon-img">
            </a> 
        </div>
    </header>

    <aside id="user-sidebar" class="sidebar">
        
        <div id="sidebar-logado" class="sidebar-profile" style="display: none;">
            <img src="perfil.jpeg" alt="Foto do Perfil">
            <p class="welcome-msg" id="welcome-msg-text">Bem-vindo!</p> 
        </div>

        <div id="sidebar-deslogado" class="sidebar-profile">
            <p class="welcome-msg">Voc√™ n√£o est√° logado.</p>
        </div>
        
        <nav class="sidebar-nav">
            <ul>
                <li id="nav-dashboard" style="display: none;"><a href="dashboard.html">Dashboard</a></li> 
                <li id="nav-cadastrar-funcionario" style="display: none;"><a href="painel-admin.html">Cadastrar Funcion√°rio</a></li> 
                
                <li id="nav-cadastrar-usuario" style="display: none;"><a href="cadastro-usuario.html">Cadastrar Usu√°rio</a></li>
                <li id="nav-registrar-livro" style="display: none;"><a href="cadastro-livro.html">üìö Registrar Livro</a></li>
                <li id="nav-realizar-aluguel" style="display: none;"><a href="alugar-livro.html">ü§ù Realizar Aluguel</a></li>

                <li id="nav-biblioteca" style="display: none;"><a href="minha-biblioteca.html">Minha Biblioteca</a></li>
                <li id="nav-alugados" style="display: none;"><a href="alugados.html">Meus Alugu√©is</a></li>
                
                <li id="nav-login"><a href="login.html">Login / Entrar</a></li>
                <li id="nav-logout" style="display: none;"><a href="#">Sair (Logout)</a></li>
            </ul>
        </nav>
    </aside>

    <main>
        <div class="container">
            <h2>Nossa Cole√ß√£o</h2>
            
            <section class="book-grid" id="lista-livros-dinamica">
                <p style="color: white; text-align: center;">Carregando livros do acervo...</p>
            </section>
            
        </div>
    </main>

    <script src="main.js"></script>

    <script>
        const API_URL = "http://localhost:8080/api";

        async function carregarLivrosDoBanco() {
            const container = document.getElementById('lista-livros-dinamica');
            
            try {
                // Chama o Back-End Java
                const response = await fetch(`${API_URL}/livros`);
                const livros = await response.json();

                container.innerHTML = ''; // Limpa a mensagem de "Carregando..."

                if (livros.length === 0) {
                    container.innerHTML = '<p style="color:white">Nenhum livro encontrado no banco de dados.</p>';
                    return;
                }

                livros.forEach(livro => {
                    // Verifica se tem imagemUrl do banco, sen√£o usa uma imagem padr√£o roxa
                    const capa = livro.imagemUrl ? livro.imagemUrl : "https://via.placeholder.com/300x400/4B0080/FFFFFF?text=Capa";

                    // Cria o card do livro
                    const card = document.createElement('article');
                    card.className = 'book-card';
                    
                    // Monta o HTML do card
                    card.innerHTML = `
                        <div class="book-cover-container">
                            <img src="${capa}" alt="Capa de ${livro.titulo}">
                        </div>
                        <div class="card-content">
                            <div>
                                <h3>${livro.titulo}</h3>
                                <p class="category">${livro.genero}</p>
                                <small style="color:#ccc; display:block; margin-bottom:5px;">ISBN: ${livro.isbn}</small>
                            </div>
                            <a href="#" class="btn btn-primary" onclick="alert('Detalhes do livro: ${livro.titulo}')">Ver mais</a>
                        </div>
                    `;
                    container.appendChild(card);
                });

            } catch (error) {
                console.error(error);
                container.innerHTML = '<p style="color:red; text-align:center;">Erro ao carregar livros. Verifique se o servidor Java est√° rodando.</p>';
            }
        }

        // Chama a fun√ß√£o assim que a p√°gina carrega
        document.addEventListener("DOMContentLoaded", carregarLivrosDoBanco);
    </script>
</body>
</html>